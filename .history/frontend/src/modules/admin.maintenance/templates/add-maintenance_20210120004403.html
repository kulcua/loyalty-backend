<box-loader loading="false" cover="1" class="cover" delay="1000"></box-loader>

<div class="heading" ng-init="newMaintenance={specialRewards: []}">
  <h1>Maintenance Register</h1>
</div>
<div style="clear: both"></div>

<form novalidate ng-submit="MaintenanceCtrl.addMaintenance(newMaintenance)">
  <div class="box-content">
    <div class="row">
      <div class="medium-12 columns">
        <admin-fieldset-block fieldset-label="'Basic Information'">
          <admin-fieldset-row
            ng-repeat="field in translatableFields"
            row-label="{{ field.label }}"
            row-prompt="{{ field.prompt }}"
            is-required="{{ language.default && field.required }}"
            input-model="newMaintenance.translations[language.code][field.key]"
            validate-by="validate.translations[language.code][field.key].errors"
          >
          </admin-fieldset-row>
        </admin-fieldset-block>

        <admin-fieldset-block fieldset-label="maintenance.reward_details">
          <div class="row">
            <div class="medium-2 small-3 columns">
              <label>{{ "maintenance.active" | translate }}</label>
            </div>
            <div
              class="medium-10 small-9 columns"
              form-validation="validate.active.errors"
            >
              <selectize
                config="MaintenanceCtrl.activeConfig"
                options="MaintenanceCtrl.active"
                ng-model="newMaintenance.active"
                ng-init="newMaintenance.active=0"
              ></selectize>
              <span class="prompt"
                >{{ "maintenance.active_prompt" | translate }}
              </span>
            </div>
          </div>

          <div class="row">
            <div class="medium-2 small-3 columns">
              <label
                >{{ "maintenance.condition_value" | translate }}
                <span class="required">*</span>
              </label>
            </div>
            <div
              class="medium-10 small-9 columns"
              form-validation="validate.conditionValue.errors"
            >
              <input
                type="number"
                min="”0″"
                step="0.5"
                ng-model="newMaintenance.conditionValue"
                required
              />
              <span class="prompt"
                >{{ "maintenance.condition_value_prompt" | translate }}
              </span>
            </div>
          </div>
          <div class="row">
            <div class="medium-2 small-3 columns">
              <label>{{ "maintenance.min_order" | translate }}</label>
            </div>
            <div
              class="medium-10 small-9 columns"
              form-validation="validate.minOrder.errors"
            >
              <input
                type="number"
                min="”0″"
                step="0.5"
                ng-model="newMaintenance.minOrder"
                required
              />
              <span class="prompt"
                >{{ "maintenance.min_order_prompt" | translate }}
              </span>
            </div>
          </div>

          <div class="row">
            <div class="medium-2 small-3 columns">
              <label
                >{{ "maintenance.reward_name" | translate }}
                <span class="required">*</span></label
              >
            </div>
            <div
              class="medium-10 small-9 columns"
              form-validation="validate.reward.name.errors"
            >
              <input
                type="text"
                ng-model="newMaintenance.reward.name"
                required
              />
              <span class="prompt"
                >{{ "maintenance.reward_name_prompt" | translate }}
              </span>
            </div>
          </div>

          <div class="row">
            <div class="medium-2 small-3 columns">
              <label
                >{{ "maintenance.reward_value" | translate }}
                <span class="required">*</span></label
              >
            </div>
            <div
              class="medium-10 small-9 columns"
              form-validation="validate.reward.value.errors"
            >
              <input
                type="number"
                min="0"
                max="100"
                step="1"
                ng-model="newMaintenance.reward.value"
                required
              />
              <span class="prompt"
                >{{ "maintenance.reward_value_prompt" | translate }}
              </span>
            </div>
          </div>
          <div class="row">
            <div class="medium-2 small-3 columns">
              <label
                >{{ "maintenance.reward_code" | translate }}
                <span class="required">*</span></label
              >
            </div>
            <div
              class="medium-10 small-9 columns"
              form-validation="validate.reward.code.errors"
            >
              <input
                type="text"
                ng-model="newMaintenance.reward.code"
                required
              />
              <span class="prompt"
                >{{ "maintenance.reward_code_prompt" | translate }}
              </span>
            </div>
          </div>
        </admin-fieldset-block>
      </div>
      <div class="medium-12 columns">
        <admin-fieldset-block
          fieldset-label="maintenance.special_reward_details"
        >
          <div
            class=""
            style="position: relative"
            ng-repeat="special in newMaintenance.specialRewards"
          >
            <div class="segment-and" ng-show="$index!=0">
              <span class="text ng-binding"
                >{{ "global.and" | translate }}</span
              >
            </div>
            <div class="collection">
              <div class="row">
                <div class="medium-3 small-3 columns">
                  <label>{{ "maintenance.active" | translate }}</label>
                </div>

                <div
                  class="medium-9 small-9 columns"
                  form-validation="validate.specialRewards[$index].active.errors"
                >
                  <selectize
                    config="MaintenanceCtrl.activeConfig"
                    options="MaintenanceCtrl.active"
                    ng-model="newMaintenance.specialRewards[$index].active"
                    ng-init="newMaintenance.specialRewards[$index].active=0"
                  ></selectize>
                  <span class="prompt"
                    >{{ "maintenance.specialreward_active_prompt" | translate }}
                  </span>
                </div>
              </div>
              <div class="row">
                <div class="medium-3 small-3 columns">
                  <label
                    >{{ "maintenance.reward_name" | translate }}
                    <span class="required">*</span></label
                  >
                </div>
                <div
                  class="medium-9 small-9 columns"
                  form-validation="validate.specialRewards[$index].name.errors"
                >
                  <input
                    type="text"
                    ng-model="newMaintenance.specialRewards[$index].name"
                    required
                  />
                  <span class="prompt"
                    >{{ "maintenance.specialreward_name_prompt" | translate }}
                  </span>
                </div>
              </div>
              <div class="row">
                <div class="medium-3 small-3 columns">
                  <label
                    >{{ "maintenance.value" | translate }}
                    <span class="required">*</span></label
                  >
                </div>
                <div
                  class="medium-9 small-9 columns"
                  form-validation="validate.specialRewards[$index].value.errors"
                >
                  <input
                    type="number"
                    min="0"
                    max="100"
                    step="1"
                    ng-model="newMaintenance.specialRewards[$index].value"
                    required
                  />
                  <span class="prompt"
                    >{{ "maintenance.specialreward_value_prompt" | translate }}
                  </span>
                </div>
              </div>
              <div class="row">
                <div class="medium-3 small-3 columns">
                  <label
                    >{{ "maintenance.reward_code" | translate }}
                    <span class="required">*</span></label
                  >
                </div>
                <div
                  class="medium-9 small-9 columns"
                  form-validation="validate.specialRewards[$index].code.errors"
                >
                  <input
                    type="text"
                    ng-model="newMaintenance.specialRewards[$index].code"
                    required
                  />
                  <span class="prompt"
                    >{{ "maintenance.specialreward_code_prompt" | translate }}
                  </span>
                </div>
              </div>
              <div class="row">
                <div class="medium-3 small-3 columns">
                  <label
                    >{{ "maintenance.start_at" | translate }}
                    <span class="required">*</span></label
                  >
                </div>
                <div
                  class="medium-9 small-9 columns"
                  form-validation="validate.specialRewards[$index].startAt.errors"
                >
                  <input
                    type="datetime"
                    datepicker
                    ng-model="newMaintenance.specialRewards[$index].startAt"
                    required
                  />
                  <span class="prompt"
                    >{{ "maintenance.specialreward_startat_prompt" | translate
                    }}
                  </span>
                </div>
              </div>
              <div class="row">
                <div class="medium-3 small-3 columns">
                  <label
                    >{{ "maintenance.end_at" | translate }}
                    <span class="required">*</span></label
                  >
                </div>
                <div
                  class="medium-9 small-9 columns"
                  form-validation="validate.specialRewards[$index].endAt.errors"
                >
                  <input
                    type="datetime"
                    datepicker
                    ng-model="newMaintenance.specialRewards[$index].endAt"
                    required
                  />
                  <span class="prompt"
                    >{{ "maintenance.specialreward_endat_prompt" | translate }}
                  </span>
                </div>
              </div>

              <button
                type="button"
                ng-click="MaintenanceCtrl.removeSpecialReward($index)"
                class="remove-collection"
              >
                <i class="fa fa-trash-o" aria-hidden="true"></i>
              </button>
            </div>
          </div>

          <div class="text-right">
            <button
              type="button"
              class="button button-secondary tiny"
              style="margin-bottom: 25px"
              ng-click="MaintenanceCtrl.addSpecialReward()"
            >
              {{ "maintenance.add_special_reward" | translate }}
            </button>
          </div>
        </admin-fieldset-block>
        <fieldset class="fieldset">
          <legend>{{ "maintenance.photo" | translate }}</legend>
          <div class="row">
            <div class="medium-2 small-3 columns">
              <label>{{ "maintenance.photo" | translate }}</label>
            </div>
            <div
              class="medium-10 small-9 columns"
              form-validation="fileValidate.file.errors"
            >
              <input
                type="file"
                file-model="$parent.$parent.maintenanceImage"
                style="padding: 9px"
              />
            </div>
          </div>
        </fieldset>
      </div>
    </div>
  </div>
  <div
    class="box-footer"
    ng-init="MaintenanceCtrl.loaderStates.maintenanceDetails=false"
  >
    <div class="row">
      <div class="columns small-12">
        <button
          class="button button-septenary-colorized float-left m-r-1"
          type="submit"
        >
          {{ "global.save" | translate }}
        </button>
        <button
          type="button"
          ui-sref="admin.maintenances-list"
          class="button button-default float-left"
          href="#"
        >
          {{ "global.cancel" | translate }}
        </button>
      </div>
      <div style="clear: both"></div>
    </div>
  </div>
</form>
